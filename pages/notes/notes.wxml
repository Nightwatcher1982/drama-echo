<view class="container fade-in">
  <view class="page-title">æˆå‰§ç¬”è®°</view>
  <view class="page-subtitle">è®°å½•æ¯ä¸€æ¬¡è§‚å‰§çš„ç¾å¥½æ—¶å…‰</view>

  <!-- æœç´¢å’Œç­›é€‰ -->
  <view class="search-section glass-card">
    <view class="search-bar">
      <input 
        class="search-input" 
        placeholder="æœç´¢å‰§ç›®åç§°ã€å‰§é™¢..." 
        value="{{searchText}}"
        bindinput="onSearchInput"
      />
      <view class="search-icon" bindtap="onSearch">ğŸ”</view>
    </view>
    <view class="filter-tabs">
      <view 
        class="filter-tab {{activeFilter === 'all' ? 'active' : ''}}"
        data-filter="all"
        bindtap="switchFilter"
      >å…¨éƒ¨</view>
      <view 
        class="filter-tab {{activeFilter === 'recent' ? 'active' : ''}}"
        data-filter="recent"
        bindtap="switchFilter"
      >æœ€è¿‘</view>
      <view 
        class="filter-tab {{activeFilter === 'favorite' ? 'active' : ''}}"
        data-filter="favorite"
        bindtap="switchFilter"
      >æ”¶è—</view>
    </view>
  </view>

  <!-- å¿«é€Ÿæ·»åŠ  -->
  <view class="quick-add glass-card">
    <button class="add-note-btn" bindtap="createNewNote">
      <view class="add-icon">âœ¨</view>
      <view class="add-text">
        <view class="add-title">è®°å½•æ–°çš„è§‚å‰§ä½“éªŒ</view>
        <view class="add-desc">åˆ†äº«ä½ çš„æˆå‰§æ•…äº‹ï¼Œè·å¾—50æˆå‰§å¸</view>
      </view>
    </button>
  </view>

  <!-- ç¬”è®°åˆ—è¡¨ -->
  <view class="notes-list" wx:if="{{filteredNotes.length > 0}}">
    <view 
      class="note-item glass-card"
      wx:for="{{filteredNotes}}"
      wx:key="id"
      bindtap="viewNote"
      data-note-id="{{item.id}}"
    >
      <view class="note-header">
        <view class="note-cover">
          <image 
            class="cover-image" 
            src="{{item.coverImage}}"
            mode="aspectFill"
            binderror="onImageError"
            bindload="onImageLoad"
          />
          <view class="image-placeholder" wx:if="{{!item.coverImage || item.coverImage === '/images/modu.png'}}">ğŸ­</view>
          <view class="note-rating" wx:if="{{item.rating}}">
            <view class="rating-stars">
              <text wx:for="{{item.ratingStars}}" wx:key="*this">{{item}}</text>
            </view>
          </view>
        </view>
        <view class="note-info">
          <view class="note-title">{{item.dramaTitle}}</view>
          <view class="note-meta">
            <view class="note-theater">ğŸ“ {{item.theater}}</view>
            <view class="note-date">ğŸ“… {{item.watchDate}}</view>
          </view>
          <view class="note-preview">{{item.content}}</view>
          <view class="note-tags" wx:if="{{item.tags.length > 0}}">
            <text class="tag" wx:for="{{item.tags}}" wx:key="*this">#{{item}}</text>
          </view>
        </view>
      </view>
      <view class="note-footer">
        <view class="note-stats">
          <view class="stat-item">
            <text class="stat-icon">ğŸ‘€</text>
            <text class="stat-count">{{item.views || 0}}</text>
          </view>
          <view class="stat-item">
            <text class="stat-icon">â¤ï¸</text>
            <text class="stat-count">{{item.likes || 0}}</text>
          </view>
          <view class="stat-item">
            <text class="stat-icon">ğŸ”—</text>
            <text class="stat-count">{{item.shares || 0}}</text>
          </view>
        </view>
        <view class="note-actions">
          <button 
            class="action-btn share-btn" 
            data-note-id="{{item.id}}"
            bindtap="shareNote"
            size="mini"
          >åˆ†äº«</button>
          <button 
            class="action-btn edit-btn"
            data-note-id="{{item.id}}"
            bindtap="editNote"
            size="mini"
          >ç¼–è¾‘</button>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:else>
    <view class="empty-icon">ğŸ“</view>
    <view class="empty-title">è¿˜æ²¡æœ‰æˆå‰§ç¬”è®°</view>
    <view class="empty-desc">è®°å½•ä½ çš„ç¬¬ä¸€æ¬¡è§‚å‰§ä½“éªŒå§</view>
    <button class="btn-primary empty-btn" bindtap="createNewNote">
      <view class="btn-text">å¼€å§‹è®°å½•</view>
    </button>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-summary glass-card" wx:if="{{notesList.length > 0}}">
    <view class="stats-title">ğŸ“Š æˆ‘çš„è§‚å‰§æ•°æ®</view>
    <view class="stats-grid">
      <view class="stat-item">
        <view class="stat-number">{{totalNotes}}</view>
        <view class="stat-label">æ€»ç¬”è®°æ•°</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">{{totalShows}}</view>
        <view class="stat-label">è§‚å‰§åœºæ¬¡</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">{{favoriteTheater}}</view>
        <view class="stat-label">æœ€çˆ±å‰§é™¢</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">{{totalEarned}}</view>
        <view class="stat-label">è·å¾—ç§¯åˆ†</view>
      </view>
    </view>
  </view>
</view> 